<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>EasyPark - Places</title>
    <link rel="stylesheet" href="easypark.css">
</head>
<body>
    <div class="container places-container">
        <h2>POPULAR PLACES NEAR YOU</h2>
        <div class="search-row">
            <input type="search" placeholder="Search places or addresses..." id="placesSearch" />
        </div>

        <div class="places-grid">
            <div class="place-link" data-map="https://www.google.com/maps?q=12.9716,77.5946&z=17&output=embed">
            <div class="place-card">
                <div class="place-img"><img src="img/airbnb.jpg" alt="AirBNB"></div>
                <div class="place-info">
                    <div class="place-name">AirBNB 1</div>
                    <div class="place-traffic traffic-low">Traffic: Low</div>
                </div>
            </div>
            </div>

            <div class="place-link" data-map="https://www.google.com/maps?q=28.7041,77.1025&z=17&output=embed">
            <div class="place-card">
                <div class="place-img"><img src="img/airbnb.jpg" alt="AirBNB"></div>
                <div class="place-info">
                    <div class="place-name">AirBNB 2</div>
                    <div class="place-traffic traffic-medium">Traffic: Medium</div>
                </div>
            </div>
            </div>

            <div class="place-card">
                <div class="place-img"><img src="img/airbnb.jpg" alt="AirBNB"></div>
                <div class="place-info">
                    <div class="place-name">AirBNB 3</div>
                    <div class="place-traffic traffic-high">Traffic: High</div>
                </div>
            </div>
            
            <div class="place-card">
                <div class="place-img"><img src="img/airbnb.jpg" alt="AirBNB"></div>
                <div class="place-info">
                    <div class="place-name">AirBNB 4</div>
                    <div class="place-traffic traffic-low">Traffic: Low</div>
                </div>
            </div>

            <div class="place-card">
                <div class="place-img"><img src="img/airbnb.jpg" alt="AirBNB"></div>
                <div class="place-info">
                    <div class="place-name">AirBNB 5</div>
                    <div class="place-traffic traffic-medium">Traffic: Medium</div>
                </div>
            </div>

            <div class="place-card">
                <div class="place-img"><img src="img/airbnb.jpg" alt="AirBNB"></div>
                <div class="place-info">
                    <div class="place-name">AirBNB 6</div>
                    <div class="place-traffic traffic-high">Traffic: High</div>
                </div>
            </div>
        </div>

    </div>

    <div id="mapModal" style="display:none;position:fixed;z-index:9999;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;">
      <div style="background:#fff;border-radius:12px;max-width:90vw;max-height:80vh;overflow:hidden;position:relative;box-shadow:0 8px 32px rgba(0,0,0,0.3);">
        <button id="closeMapModal" style="position:absolute;top:8px;right:8px;background:#283593;color:#fff;border:none;border-radius:50%;width:32px;height:32px;font-size:1.3rem;cursor:pointer;">&times;</button>
        <iframe id="mapFrame" src="" width="400" height="350" style="border:0;display:block;max-width:90vw;max-height:70vh;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
    </div>
    <script>
        // Search/filter functionality for places
        (function(){
            const searchInput = document.getElementById('placesSearch');
            const cards = Array.from(document.querySelectorAll('.place-card'));

            function normalize(s){
                return (s||'').trim().toLowerCase();
            }

            function filterCards(){
                const q = normalize(searchInput.value);
                if(!q){
                    // empty -> show all
                    cards.forEach(c => c.style.display = 'flex');
                    return;
                }

                // If the user types an exact full name (like "airbnb 1"), only match exact names.
                // We'll treat queries that include a number at the end as exact-name intent.
                const exactNamePattern = /\d+$/;
                const isExactName = exactNamePattern.test(q);

                cards.forEach(card => {
                    const nameEl = card.querySelector('.place-name');
                    const name = normalize(nameEl && nameEl.textContent);

                    let show = false;
                    if(isExactName){
                        show = name === q; // exact match
                    } else {
                        // partial match anywhere in the name
                        show = name.indexOf(q) !== -1;
                    }

                    card.style.display = show ? 'flex' : 'none';
                });
            }

            searchInput.addEventListener('input', filterCards);
            // allow searching when pressing Enter too
            searchInput.addEventListener('keyup', function(e){ if(e.key === 'Enter') filterCards(); });
        })();

        // Modal map popup for AirBNB 1 and 2
        document.querySelectorAll('.place-link[data-map]').forEach(function(link){
          link.addEventListener('click', function(e){
            e.preventDefault();
            var mapUrl = link.getAttribute('data-map');
            var modal = document.getElementById('mapModal');
            var frame = document.getElementById('mapFrame');
            frame.src = mapUrl;
            modal.style.display = 'flex';
          });
        });
        document.getElementById('closeMapModal').onclick = function(){
          document.getElementById('mapModal').style.display = 'none';
          document.getElementById('mapFrame').src = '';
        };
        // Optional: close modal on background click
        document.getElementById('mapModal').addEventListener('click', function(e){
          if(e.target === this){
            this.style.display = 'none';
            document.getElementById('mapFrame').src = '';
          }
        });
    </script>
</body>
</html>